<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="VantaSpeech.Views.RecordingPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:VantaSpeech.Views"
    xmlns:vm="using:VantaSpeech.ViewModels"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid Padding="40">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Status text -->
        <TextBlock
            Grid.Row="0"
            Text="{x:Bind ViewModel.StatusText, Mode=OneWay}"
            Style="{StaticResource SubtitleTextBlockStyle}"
            HorizontalAlignment="Center"
            Foreground="{ThemeResource SystemAccentColor}" />

        <!-- Timer and visualizer -->
        <StackPanel
            Grid.Row="1"
            VerticalAlignment="Center"
            HorizontalAlignment="Center"
            Spacing="40">

            <!-- Duration display -->
            <TextBlock
                Text="{x:Bind ViewModel.FormattedDuration, Mode=OneWay}"
                FontSize="72"
                FontWeight="Light"
                HorizontalAlignment="Center" />

            <!-- Audio level visualizer (simplified) -->
            <ProgressBar
                x:Name="AudioLevelBar"
                Value="{x:Bind ViewModel.AudioLevel, Mode=OneWay}"
                Maximum="1"
                Width="300"
                Height="8"
                Visibility="{x:Bind ViewModel.IsActive, Mode=OneWay}" />

            <!-- Record button -->
            <Button
                Width="120"
                Height="120"
                CornerRadius="60"
                Background="{StaticResource RecordingRedBrush}"
                Command="{x:Bind ViewModel.ToggleRecordingCommand}"
                HorizontalAlignment="Center">
                <Grid>
                    <Ellipse
                        Width="50"
                        Height="50"
                        Fill="White"
                        Visibility="{x:Bind ViewModel.IsRecording, Mode=OneWay, Converter={StaticResource BoolToVisibilityInverseConverter}}" />
                    <Rectangle
                        Width="40"
                        Height="40"
                        Fill="White"
                        RadiusX="4"
                        RadiusY="4"
                        Visibility="{x:Bind ViewModel.IsRecording, Mode=OneWay}" />
                </Grid>
            </Button>
        </StackPanel>

        <!-- Controls for active recording -->
        <StackPanel
            Grid.Row="2"
            Orientation="Horizontal"
            HorizontalAlignment="Center"
            Spacing="16"
            Visibility="{x:Bind ViewModel.IsActive, Mode=OneWay}">

            <!-- Pause/Resume button -->
            <Button
                Command="{x:Bind ViewModel.TogglePauseCommand}"
                Style="{StaticResource AccentButtonStyle}"
                Width="48"
                Height="48"
                CornerRadius="24">
                <FontIcon
                    Glyph="{x:Bind ViewModel.IsPaused, Mode=OneWay, Converter={StaticResource PauseIconConverter}}"
                    FontSize="20" />
            </Button>

            <!-- Stop button -->
            <Button
                Command="{x:Bind ViewModel.StopRecordingCommand}"
                Background="{ThemeResource SystemFillColorCriticalBrush}"
                Width="100"
                Height="48">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon Glyph="&#xE71A;" FontSize="16" />
                    <TextBlock Text="Stop" />
                </StackPanel>
            </Button>
        </StackPanel>
    </Grid>
</Page>
